var sourceData307 = {"FileName":"C:\\local\\mw\\gh-isaacito12-bev\\Utility\\LocalTasks\\screenshotSimulink.m","RawFileContents":["function result = screenshotSimulink(nvpairs)","%% Saves the screenshot of a Simulink model to an image file.","%","% The simplest way to use this function is to pass the Simulink model name.","% This saves a screenshot image in PNG format in the current folder.","%   result = screenshotSimulink(SimulinkModelName=\"ssc_dcmotor\");","% Returned data is a struct containing the file name","% of a produced screenshot image as well as the width and height of it.","%","% You can use options to control the size of the image file,","% subsystem to take a screenshot, and so on.","% For details, see the arguments block below.","","% Copyright 2021-2023 The MathWorks, Inc.","","arguments","","  % The name of the model you want to take a screenshot.","  % By default, the screenshot is taken for the top layer.","  % To take the screenshot of a subsystem, use SubsystemPath option.","  nvpairs.SimulinkModelName {mustBeTextScalar}","","  % Path to the subsystem to take screenshot,","  % for example, SubsystemPath=\"/Subsystem1\".","  % Default is an empty string \"\", and the top layer is the target.","  nvpairs.SubsystemPath {mustBeTextScalar} = \"\"","","  % Screenshot file is saved as a PNG file.","  % Default file name of the screenshot is \"image_<SimulinkModelName>.png\".","  % To specify the image file name, use OutputFileName option.","  % The file name is passed to imwrite function.","  nvpairs.OutputFileName {mustBeTextScalar}","","  % Folder path to save image file.","  % If this is empty, image file is saved in the current folder.","  nvpairs.SaveFolder {mustBeTextScalar} = \"\"","","  % Width and height of the image file to produce.","  nvpairs.OutputImageWidth_px (1,1) {mustBeInteger, mustBeNonnegative} = 0","  nvpairs.OutputImageHeight_px (1,1) {mustBeInteger, mustBeNonnegative} = 0","","  % You can add a padding around the model image.","  % The screenshot size is adjusted and centered.","  nvpairs.PaddingHorizontal_px (1,1) {mustBeInteger, mustBeNonnegative} = 0","  nvpairs.PaddingVertical_px (1,1) {mustBeInteger, mustBeNonnegative} = 0","  % [0 0 0] is black. [1 1 1] is white.","  nvpairs.PaddingColorRGB (1,3) {mustBeInRange(nvpairs.PaddingColorRGB, 0, 1)} = [1,1,1]","","  % Options below are for test purposes.","","  % To test this function without using a Simulink model to take screenshot,","  % set StandaloneTest to true.","  % If this is true, SimulinkModelName is ignored.","  nvpairs.StandaloneTest (1,1) logical = false","","  % This is for test purpose.","  nvpairs.DoNotSaveImageFile (1,1) logical = false","","end","","standaloneTest = nvpairs.StandaloneTest;","","if isfield(nvpairs, 'SimulinkModelName')","  modelName = nvpairs.SimulinkModelName;","else","  modelName = \"\";","end","result.SimulinkModelName = modelName;","","if isfield(nvpairs, 'OutputFileName')","  outputFileName = nvpairs.OutputFileName;","else","  if modelName == \"\"","    outputFileName = \"Unspecified.png\";","  else","    outputFileName = \"image_\" + modelName + \".png\";","  end","end","result.OutputFileName = outputFileName;","","outputFullPath = fullfile(nvpairs.SaveFolder, outputFileName);","result.OutputFullPath = outputFullPath;","","subsystemPath = nvpairs.SubsystemPath;","if subsystemPath ~= \"\"","  if not(startsWith(subsystemPath, \"/\"))","    subsystemPath = \"/\" + subsystemPath;","  end","end","","% The values of these variables can be 0 at this point.","% They are fully determined later.","rows_final = nvpairs.OutputImageHeight_px;","cols_final = nvpairs.OutputImageWidth_px;","","padX = nvpairs.PaddingHorizontal_px;","padY = nvpairs.PaddingVertical_px;","padRGB = 256 * nvpairs.PaddingColorRGB;","","if standaloneTest","  rows = 600;","  cols = 800;","  screenshotImage = uint8( 255*ones(rows, cols, 3) );  % 0 - 255","  screenshotImage(:,:,1) = screenshotImage(:,:,1)*0.1;  % Red","  screenshotImage(:,:,2) = screenshotImage(:,:,2)*0.4;  % Green","  screenshotImage(:,:,3) = screenshotImage(:,:,3)*0.1;  % Blue","else","  if not(bdIsLoaded(modelName))","    load_system(modelName)","  end","  subsystemFullPath = modelName + subsystemPath;","  listOfBlocks = getfullname(Simulink.findBlocks(modelName));","  tf = contains(listOfBlocks, subsystemFullPath);","  if not(any(tf))","    error(\"Specified subsystem does not exist: \" + subsystemFullPath)","  end","  % Take screenshot. It is saved in a file.","  print(\"-s\" + subsystemFullPath, ...","        \"-dpng\", outputFullPath)","  screenshotImage = imread(outputFullPath);","end","","rows_orig = height(screenshotImage);","cols_orig = width(screenshotImage);","result.OriginalImageWidth = cols_orig;","result.OriginalImageHeight = rows_orig;","","if rows_final == 0 && cols_final > 0","  rows_final = ceil(rows_orig * cols_final/cols_orig);","elseif rows_final > 0 && cols_final == 0","  cols_final = ceil(cols_orig * rows_final/rows_orig);","elseif rows_final > 0 && cols_final > 0","  % do nothing.","else","  rows_final = rows_orig;","  cols_final = cols_orig;","end","result.FinalImageWidth = cols_final;","result.FinalImageHeight = rows_final;","","% Compute target size to resize the original image.","rows_target = rows_final - padY*2;","cols_target = cols_final - padX*2;","","assert(rows_target > 0, \"Invalid image height %d\", rows_target)","assert(cols_target > 0, \"Invalid image width %d\", cols_target)","","result.ResizedImageWidth = cols_target;","result.ResizedImageHeight = rows_target;","","if padX==0 && padY==0 && rows_final==rows_orig && cols_final==cols_orig","  resultImg = screenshotImage;","else","  resizedImage = imresize(screenshotImage, [rows_target, cols_target]);","","  % uint8 is necessary to manipulate data as PNG.","  resultImg = uint8( ones(rows_final, cols_final, 3) );","  resultImg(:,:,1) = padRGB(1)*resultImg(:,:,1);","  resultImg(:,:,2) = padRGB(2)*resultImg(:,:,2);","  resultImg(:,:,3) = padRGB(3)*resultImg(:,:,3);","","  % Superimpose the screenshot on top of the rectangle.","  % Screenshot is placed at the center.","  resultImg( padY+(1:height(resizedImage)) , padX+(1:width(resizedImage)) , : ) = resizedImage;","end","","if nvpairs.DoNotSaveImageFile","  disp(\"Not saving screenshot image to a file.\")","  % print() created a file unless Standalone option is used.","  if isfile(outputFullPath)","    delete(outputFullPath)","  end","else","  imwrite(resultImg, outputFullPath)","end","","end  % function",""],"CoverageDisplayDataPerLine":{"Function":{"LineNumber":1,"Hits":0,"StartColumnNumbers":0,"EndColumnNumbers":45,"ContinuedLine":false},"Statement":[{"LineNumber":21,"Hits":0,"StartColumnNumbers":29,"EndColumnNumbers":45,"ContinuedLine":false},{"LineNumber":26,"Hits":[0,0],"StartColumnNumbers":[25,45],"EndColumnNumbers":[41,47],"ContinuedLine":false},{"LineNumber":32,"Hits":0,"StartColumnNumbers":26,"EndColumnNumbers":42,"ContinuedLine":false},{"LineNumber":36,"Hits":[0,0],"StartColumnNumbers":[22,42],"EndColumnNumbers":[38,44],"ContinuedLine":false},{"LineNumber":39,"Hits":[0,0,0],"StartColumnNumbers":[37,52,73],"EndColumnNumbers":[50,69,74],"ContinuedLine":false},{"LineNumber":40,"Hits":[0,0,0],"StartColumnNumbers":[38,53,74],"EndColumnNumbers":[51,70,75],"ContinuedLine":false},{"LineNumber":44,"Hits":[0,0,0],"StartColumnNumbers":[38,53,74],"EndColumnNumbers":[51,70,75],"ContinuedLine":false},{"LineNumber":45,"Hits":[0,0,0],"StartColumnNumbers":[36,51,72],"EndColumnNumbers":[49,68,73],"ContinuedLine":false},{"LineNumber":47,"Hits":[0,0],"StartColumnNumbers":[33,81],"EndColumnNumbers":[77,88],"ContinuedLine":false},{"LineNumber":54,"Hits":0,"StartColumnNumbers":41,"EndColumnNumbers":46,"ContinuedLine":false},{"LineNumber":57,"Hits":0,"StartColumnNumbers":45,"EndColumnNumbers":50,"ContinuedLine":false},{"LineNumber":61,"Hits":0,"StartColumnNumbers":0,"EndColumnNumbers":40,"ContinuedLine":false},{"LineNumber":63,"Hits":0,"StartColumnNumbers":0,"EndColumnNumbers":40,"ContinuedLine":false},{"LineNumber":64,"Hits":0,"StartColumnNumbers":2,"EndColumnNumbers":40,"ContinuedLine":false},{"LineNumber":66,"Hits":0,"StartColumnNumbers":2,"EndColumnNumbers":17,"ContinuedLine":false},{"LineNumber":68,"Hits":0,"StartColumnNumbers":0,"EndColumnNumbers":37,"ContinuedLine":false},{"LineNumber":70,"Hits":0,"StartColumnNumbers":0,"EndColumnNumbers":37,"ContinuedLine":false},{"LineNumber":71,"Hits":0,"StartColumnNumbers":2,"EndColumnNumbers":42,"ContinuedLine":false},{"LineNumber":73,"Hits":0,"StartColumnNumbers":2,"EndColumnNumbers":20,"ContinuedLine":false},{"LineNumber":74,"Hits":0,"StartColumnNumbers":4,"EndColumnNumbers":39,"ContinuedLine":false},{"LineNumber":76,"Hits":0,"StartColumnNumbers":4,"EndColumnNumbers":51,"ContinuedLine":false},{"LineNumber":79,"Hits":0,"StartColumnNumbers":0,"EndColumnNumbers":39,"ContinuedLine":false},{"LineNumber":81,"Hits":0,"StartColumnNumbers":0,"EndColumnNumbers":62,"ContinuedLine":false},{"LineNumber":82,"Hits":0,"StartColumnNumbers":0,"EndColumnNumbers":39,"ContinuedLine":false},{"LineNumber":84,"Hits":0,"StartColumnNumbers":0,"EndColumnNumbers":38,"ContinuedLine":false},{"LineNumber":85,"Hits":0,"StartColumnNumbers":0,"EndColumnNumbers":22,"ContinuedLine":false},{"LineNumber":86,"Hits":0,"StartColumnNumbers":2,"EndColumnNumbers":40,"ContinuedLine":false},{"LineNumber":87,"Hits":0,"StartColumnNumbers":4,"EndColumnNumbers":40,"ContinuedLine":false},{"LineNumber":93,"Hits":0,"StartColumnNumbers":0,"EndColumnNumbers":42,"ContinuedLine":false},{"LineNumber":94,"Hits":0,"StartColumnNumbers":0,"EndColumnNumbers":41,"ContinuedLine":false},{"LineNumber":96,"Hits":0,"StartColumnNumbers":0,"EndColumnNumbers":36,"ContinuedLine":false},{"LineNumber":97,"Hits":0,"StartColumnNumbers":0,"EndColumnNumbers":34,"ContinuedLine":false},{"LineNumber":98,"Hits":0,"StartColumnNumbers":0,"EndColumnNumbers":39,"ContinuedLine":false},{"LineNumber":100,"Hits":0,"StartColumnNumbers":0,"EndColumnNumbers":17,"ContinuedLine":false},{"LineNumber":101,"Hits":0,"StartColumnNumbers":2,"EndColumnNumbers":13,"ContinuedLine":false},{"LineNumber":102,"Hits":0,"StartColumnNumbers":2,"EndColumnNumbers":13,"ContinuedLine":false},{"LineNumber":103,"Hits":0,"StartColumnNumbers":2,"EndColumnNumbers":53,"ContinuedLine":false},{"LineNumber":104,"Hits":0,"StartColumnNumbers":2,"EndColumnNumbers":54,"ContinuedLine":false},{"LineNumber":105,"Hits":0,"StartColumnNumbers":2,"EndColumnNumbers":54,"ContinuedLine":false},{"LineNumber":106,"Hits":0,"StartColumnNumbers":2,"EndColumnNumbers":54,"ContinuedLine":false},{"LineNumber":108,"Hits":0,"StartColumnNumbers":2,"EndColumnNumbers":31,"ContinuedLine":false},{"LineNumber":109,"Hits":0,"StartColumnNumbers":4,"EndColumnNumbers":26,"ContinuedLine":false},{"LineNumber":111,"Hits":0,"StartColumnNumbers":2,"EndColumnNumbers":48,"ContinuedLine":false},{"LineNumber":112,"Hits":0,"StartColumnNumbers":2,"EndColumnNumbers":61,"ContinuedLine":false},{"LineNumber":113,"Hits":0,"StartColumnNumbers":2,"EndColumnNumbers":49,"ContinuedLine":false},{"LineNumber":114,"Hits":0,"StartColumnNumbers":2,"EndColumnNumbers":17,"ContinuedLine":false},{"LineNumber":115,"Hits":0,"StartColumnNumbers":4,"EndColumnNumbers":69,"ContinuedLine":false},{"LineNumber":118,"Hits":0,"StartColumnNumbers":2,"EndColumnNumbers":32,"ContinuedLine":false},{"LineNumber":119,"Hits":0,"StartColumnNumbers":8,"EndColumnNumbers":32,"ContinuedLine":true},{"LineNumber":120,"Hits":0,"StartColumnNumbers":2,"EndColumnNumbers":43,"ContinuedLine":false},{"LineNumber":123,"Hits":0,"StartColumnNumbers":0,"EndColumnNumbers":36,"ContinuedLine":false},{"LineNumber":124,"Hits":0,"StartColumnNumbers":0,"EndColumnNumbers":35,"ContinuedLine":false},{"LineNumber":125,"Hits":0,"StartColumnNumbers":0,"EndColumnNumbers":38,"ContinuedLine":false},{"LineNumber":126,"Hits":0,"StartColumnNumbers":0,"EndColumnNumbers":39,"ContinuedLine":false},{"LineNumber":128,"Hits":0,"StartColumnNumbers":0,"EndColumnNumbers":36,"ContinuedLine":false},{"LineNumber":129,"Hits":0,"StartColumnNumbers":2,"EndColumnNumbers":54,"ContinuedLine":false},{"LineNumber":130,"Hits":0,"StartColumnNumbers":0,"EndColumnNumbers":40,"ContinuedLine":false},{"LineNumber":131,"Hits":0,"StartColumnNumbers":2,"EndColumnNumbers":54,"ContinuedLine":false},{"LineNumber":132,"Hits":0,"StartColumnNumbers":0,"EndColumnNumbers":39,"ContinuedLine":false},{"LineNumber":135,"Hits":0,"StartColumnNumbers":2,"EndColumnNumbers":25,"ContinuedLine":false},{"LineNumber":136,"Hits":0,"StartColumnNumbers":2,"EndColumnNumbers":25,"ContinuedLine":false},{"LineNumber":138,"Hits":0,"StartColumnNumbers":0,"EndColumnNumbers":36,"ContinuedLine":false},{"LineNumber":139,"Hits":0,"StartColumnNumbers":0,"EndColumnNumbers":37,"ContinuedLine":false},{"LineNumber":142,"Hits":0,"StartColumnNumbers":0,"EndColumnNumbers":34,"ContinuedLine":false},{"LineNumber":143,"Hits":0,"StartColumnNumbers":0,"EndColumnNumbers":34,"ContinuedLine":false},{"LineNumber":145,"Hits":0,"StartColumnNumbers":0,"EndColumnNumbers":63,"ContinuedLine":false},{"LineNumber":146,"Hits":0,"StartColumnNumbers":0,"EndColumnNumbers":62,"ContinuedLine":false},{"LineNumber":148,"Hits":0,"StartColumnNumbers":0,"EndColumnNumbers":39,"ContinuedLine":false},{"LineNumber":149,"Hits":0,"StartColumnNumbers":0,"EndColumnNumbers":40,"ContinuedLine":false},{"LineNumber":151,"Hits":0,"StartColumnNumbers":0,"EndColumnNumbers":71,"ContinuedLine":false},{"LineNumber":152,"Hits":0,"StartColumnNumbers":2,"EndColumnNumbers":30,"ContinuedLine":false},{"LineNumber":154,"Hits":0,"StartColumnNumbers":2,"EndColumnNumbers":71,"ContinuedLine":false},{"LineNumber":157,"Hits":0,"StartColumnNumbers":2,"EndColumnNumbers":55,"ContinuedLine":false},{"LineNumber":158,"Hits":0,"StartColumnNumbers":2,"EndColumnNumbers":48,"ContinuedLine":false},{"LineNumber":159,"Hits":0,"StartColumnNumbers":2,"EndColumnNumbers":48,"ContinuedLine":false},{"LineNumber":160,"Hits":0,"StartColumnNumbers":2,"EndColumnNumbers":48,"ContinuedLine":false},{"LineNumber":164,"Hits":0,"StartColumnNumbers":2,"EndColumnNumbers":95,"ContinuedLine":false},{"LineNumber":167,"Hits":0,"StartColumnNumbers":0,"EndColumnNumbers":29,"ContinuedLine":false},{"LineNumber":168,"Hits":0,"StartColumnNumbers":2,"EndColumnNumbers":48,"ContinuedLine":false},{"LineNumber":170,"Hits":0,"StartColumnNumbers":2,"EndColumnNumbers":27,"ContinuedLine":false},{"LineNumber":171,"Hits":0,"StartColumnNumbers":4,"EndColumnNumbers":26,"ContinuedLine":false},{"LineNumber":174,"Hits":0,"StartColumnNumbers":2,"EndColumnNumbers":36,"ContinuedLine":false}]}}