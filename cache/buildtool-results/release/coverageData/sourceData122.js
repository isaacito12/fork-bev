var sourceData122 = {"FileName":"C:\\local\\mw\\gh-isaacito12-bev\\Components\\MotorDriveUnit\\Utility\\MotorDriveUnit_plotEfficiency.m","RawFileContents":["function fig = MotorDriveUnit_plotEfficiency(nvpairs)","%% Makes a plot of power conversion efficiency/losses for motor drive unit","% This function takes arguments corresponding to block parameters","% of the following blocks:","%","%   - Motor & Drive block, from Simscape Driveline","%   - Motor & Drive (System Level) block, from Simscape Electrical","%","% and makes a plot of electric-to-mechanical power conversion efficiency map","% as a function of motor speed and torque.","%","% You can run this function without arguments,","% and it will create a plot using default argument values.","%","% No that Motor & Drive (System Level) block supports","% various ways to accept block parameters, but","% this function makes a plot for it assuming the following case:","%","%   Electrical Torque","%     - Parameterized by: Maximum torque and power","%   Electrical Losses","%     - Parameterize losses by: Single efficiency measurement","%","% To make an efficiency plot for other cases","% in Motor & Drive (System Level) block,","% use the \"Plot efficiency map\" link in the block Description.","","% Copyright 2021-2023 The MathWorks, Inc.","","arguments","  % In road vehicle applications,","  % maximum motor speed is determined by vehicle top speed,","  % tire rolling radius, and reduction gear ratio. ","  nvpairs.MaxSpeed_rpm (1,1) double {mustBePositive} = 17000","","  nvpairs.MaxTorque_Nm (1,1) double {mustBePositive} = 163","  nvpairs.MaxPower_kW (1,1) double {mustBePositive} = 53","","  nvpairs.Efficiency_pct (1,1) double {mustBePositive} = 95","  nvpairs.Speed_measured_rpm (1,1) double {mustBeNonnegative} = 2000","  nvpairs.Torque_measured_Nm (1,1) double {mustBeNonnegative} = 50","","  % In Motor & Drive block from Simscape Driveline,","  % iron loss, constant electrical loss, and rotor friction are not modelled,","  % i.e., they are 0. ","  nvpairs.IronToNominalLossRatio_pct (1,1) double {mustBeNonnegative} = 0.1","  nvpairs.FixedLoss_W (1,1) double {mustBeNonnegative} = 40","  nvpairs.RotorDamping_Nm_per_radps (1,1) double {mustBeNonnegative} = 0.05","","  % Contour levels need 3 or more points for lower bound, upper bound,","  % and one or more points in between.","  nvpairs.ContourLevels_pct (1,:) double {mustBeNonnegative} = [1 60 80 90 92 94 96 97 98 99]","","  nvpairs.PlotResolution (1,1) {mustBeInteger, mustBePositive} = 500","end","","trq_max_Nm = nvpairs.MaxTorque_Nm;","","spd_max_rpm = nvpairs.MaxSpeed_rpm;","","power_max_W = 1000* nvpairs.MaxPower_kW;","","eff_norm = nvpairs.Efficiency_pct/100;","","spd_eff_rpm = nvpairs.Speed_measured_rpm;","","trq_eff_Nm = nvpairs.Torque_measured_Nm;","","% normalized","iron_to_nominal_loss_ratio = nvpairs.IronToNominalLossRatio_pct / 100;","","loss_const_W = nvpairs.FixedLoss_W;","","k_damp = nvpairs.RotorDamping_Nm_per_radps;","","contour_levels = nvpairs.ContourLevels_pct;","assert(numel(contour_levels) > 2, ...","  \"Contour levels need 3 or more elements, but \" ...","  + \"it has only \" + numel(contour_levels) + \" levels.\")","","plotResolution = nvpairs.PlotResolution;","","%% Derived parameters","","spd_eff_radps = spd_eff_rpm*2*pi/60;","","% Mechanical power at efficiency measurement point","mechpow_eff = spd_eff_radps * trq_eff_Nm;","","% Nominal loss (total loss at efficiency measurement point","nominal_loss_eff = (1/eff_norm - 1) * mechpow_eff;","","% Iron loss at efficiency measurement point","iron_loss_eff = iron_to_nominal_loss_ratio * nominal_loss_eff;","","% Copper loss at efficiency measurement point","copper_loss_eff = nominal_loss_eff - iron_loss_eff;","","% Copper loss coefficient for copper loss model","k_copper = copper_loss_eff/trq_eff_Nm^2;","","% Iron loss coefficient for iron loss model","k_iron = iron_loss_eff/spd_eff_radps^2;","","%% Plot","","% x-axis ... speed","w_rpm_vec = linspace(1, spd_max_rpm, plotResolution);","w_radps_vec = w_rpm_vec/60*2*pi;  % rad/s","","% y-axis ... torque","trq_Nm_vec = linspace(0, trq_max_Nm, plotResolution)';","","trq_max_envelope = min(power_max_W ./ w_radps_vec, trq_max_Nm);","","% Calculation below is done in x-y mesh.","[w, trq] = meshgrid(w_radps_vec, trq_Nm_vec);","","% A mask matrix with 1 for valid, 0 for invalid regions.","% This is later multiplied to the efficiency matrix","% to set regions over the maximum power to 0.","valid_region_mat = trq < trq_max_envelope;","","% Fixed electrical loss","Pb = loss_const_W*ones(plotResolution, plotResolution);","","kc = k_copper;  % Copper loss coefficient","ki = k_iron;  % Iron loss coefficient","kd = k_damp;  % Rotor friction coefficient","","trq_elec = abs(trq) - kd*w;  % Steady state","Lc = kc*trq_elec.^2;  % Copper loss model","Li = ki*w.^2;  % Iron loss model","L_elec = Pb + Lc + Li;  % Total electrical loss","mech_power = trq.*w;  % Mechanical power","eff = 100 * abs(mech_power) ./(L_elec + abs(mech_power));  % Efficiency in percent","","% Apply mask","eff = valid_region_mat .* eff;","","fig = figure;  hold on","contourf(w_rpm_vec, trq_Nm_vec, eff, contour_levels, ShowText=\"on\")","plot(w_rpm_vec, trq_max_envelope, LineWidth=3, Color=\"blue\")","sct = scatter(spd_eff_rpm, trq_eff_Nm, \"x\");","sct.Marker = \"x\";","sct.LineWidth = 1;","sct.SizeData = 100;","sct.MarkerEdgeColor = \"black\";","xlim([0 spd_max_rpm])","ylim([0 trq_max_Nm])","xlabel(\"Speed (rpm)\")","ylabel(\"Torque (Nm)\")","title(\"Overall Efficiency of Motor Drive Unit (%)\")","","end",""],"CoverageDisplayDataPerLine":{"Function":{"LineNumber":1,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":53,"ContinuedLine":false,"Filterable":true,"FilterDataUUID":"6761c8b3-52a2-4a4f-9c2f-4e59b8686d54"},"Statement":[{"LineNumber":34,"Hits":[4,1],"StartColumnNumbers":[37,55],"EndColumnNumbers":[51,60],"ContinuedLine":false,"Filterable":[false,false],"FilterDataUUID":["317a5d8a-f422-4caa-bec3-9c928b020e99","08e107f6-c2cf-4fc7-afa6-c1dd72f6c366"]},{"LineNumber":36,"Hits":[4,1],"StartColumnNumbers":[37,55],"EndColumnNumbers":[51,58],"ContinuedLine":false,"Filterable":[false,false],"FilterDataUUID":["2e0fd4ea-026d-46a0-864f-d8bdc2dc8329","3b4c00bd-c392-4c81-9968-f3592d5ccc8d"]},{"LineNumber":37,"Hits":[4,1],"StartColumnNumbers":[36,54],"EndColumnNumbers":[50,56],"ContinuedLine":false,"Filterable":[false,false],"FilterDataUUID":["91dd60d5-2937-4a15-a6d4-5303919ff43e","ff329924-334a-4379-9881-147ad8f8db2a"]},{"LineNumber":39,"Hits":[4,1],"StartColumnNumbers":[39,57],"EndColumnNumbers":[53,59],"ContinuedLine":false,"Filterable":[false,false],"FilterDataUUID":["cc544c20-e17e-48ee-a61e-e9c2fef2a8c4","3029f2c6-1984-47db-9975-210598122f10"]},{"LineNumber":40,"Hits":[4,1],"StartColumnNumbers":[43,64],"EndColumnNumbers":[60,68],"ContinuedLine":false,"Filterable":[false,false],"FilterDataUUID":["4af24f70-e277-4561-94c5-95a2fd913ee1","ea7c8837-3725-4775-a9bb-90ac8806656d"]},{"LineNumber":41,"Hits":[4,1],"StartColumnNumbers":[43,64],"EndColumnNumbers":[60,66],"ContinuedLine":false,"Filterable":[false,false],"FilterDataUUID":["d98f77ad-8ea2-4c8d-a111-1763f6f0314a","08a90ac0-d0ad-4db3-8f54-3b130e8300e2"]},{"LineNumber":46,"Hits":[4,1],"StartColumnNumbers":[51,72],"EndColumnNumbers":[68,75],"ContinuedLine":false,"Filterable":[false,false],"FilterDataUUID":["e9ce01b8-172f-4fba-9ce7-d62cf50fbdd0","c3d462b8-166a-4d59-884c-a6d4a484f253"]},{"LineNumber":47,"Hits":[4,1],"StartColumnNumbers":[36,57],"EndColumnNumbers":[53,59],"ContinuedLine":false,"Filterable":[false,false],"FilterDataUUID":["e3d24538-57c9-4625-b7db-19646516df08","c7909929-4491-435b-9336-c02b9bc9cce5"]},{"LineNumber":48,"Hits":[4,1],"StartColumnNumbers":[50,71],"EndColumnNumbers":[67,75],"ContinuedLine":false,"Filterable":[false,false],"FilterDataUUID":["db057bcb-dfb5-4d95-bb58-dc31defd3763","36adc1bd-d6ee-4ddf-a2b3-4d64a037319b"]},{"LineNumber":52,"Hits":[4,1],"StartColumnNumbers":[42,63],"EndColumnNumbers":[59,93],"ContinuedLine":false,"Filterable":[false,false],"FilterDataUUID":["d1738c2d-7932-484a-a23d-a6081c022c2b","3cbf753c-075a-459b-abdd-107a7a5df725"]},{"LineNumber":54,"Hits":[4,4,1],"StartColumnNumbers":[32,47,65],"EndColumnNumbers":[45,61,68],"ContinuedLine":false,"Filterable":[false,false,false],"FilterDataUUID":["e4ddde45-d55e-442d-ab86-05ada5be8476","af78f62f-004e-4adf-8c56-7302606db0c5","8d588506-48ae-42ac-907e-728f21c1907b"]},{"LineNumber":57,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":34,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"20eb14d5-5fcc-433e-b394-9fcc8dcc0573"},{"LineNumber":59,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":35,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"0d4f04b5-ee96-4656-93ef-5eca407a9702"},{"LineNumber":61,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":40,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"8c886be6-5789-42f4-af8a-b0d287fea05e"},{"LineNumber":63,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":38,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"8b7af596-d0e7-4739-b1e2-76574c4d4d5d"},{"LineNumber":65,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":41,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"9fec39d9-9f65-4eaf-b56b-c748ebab9be9"},{"LineNumber":67,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":40,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"c7b88c85-b710-4eca-861e-9893381aed40"},{"LineNumber":70,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":70,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"4acb87d9-6ee6-4a33-8ebf-283e5ff9e1cd"},{"LineNumber":72,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":35,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"a8472b73-057c-4ffd-a61a-7ce035c96997"},{"LineNumber":74,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":43,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"e6f32b07-8ba1-40f2-831d-74ac4a022f45"},{"LineNumber":76,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":43,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"9eb613f0-0b31-4b52-9da0-23a62762b7fd"},{"LineNumber":77,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":32,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"2fdf4f7e-5e5f-4b68-89ea-226488b7d0d0"},{"LineNumber":78,"Hits":4,"StartColumnNumbers":2,"EndColumnNumbers":48,"ContinuedLine":true,"Filterable":false,"FilterDataUUID":"2fdf4f7e-5e5f-4b68-89ea-226488b7d0d0"},{"LineNumber":79,"Hits":4,"StartColumnNumbers":2,"EndColumnNumbers":56,"ContinuedLine":true,"Filterable":false,"FilterDataUUID":"2fdf4f7e-5e5f-4b68-89ea-226488b7d0d0"},{"LineNumber":81,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":40,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"ac980e62-5555-4af2-ae38-b89e712a7c90"},{"LineNumber":85,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":36,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"d40f6e20-13c1-469e-9e66-b7a9b1faa8d3"},{"LineNumber":88,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":41,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"e0f24325-0f5e-43cc-95bc-3d24e15bbab0"},{"LineNumber":91,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":50,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"7ae2fd9b-5d45-4029-b054-d3a0d786ca44"},{"LineNumber":94,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":62,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"7e3051a0-144a-4003-a2f8-7a913bf3b733"},{"LineNumber":97,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":51,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"73bffd09-8687-4b5c-b74d-ae8bb6ba8fab"},{"LineNumber":100,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":40,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"8bdd26c4-5d73-46c8-8d25-7ac1a289c0ba"},{"LineNumber":103,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":39,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"0e795a73-99bb-424b-8469-ec9da0d3f341"},{"LineNumber":108,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":53,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"3affb0f5-1ab7-4b22-8cfa-27bbef264d8a"},{"LineNumber":109,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":32,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"240c2307-b226-4653-9571-ff0307919310"},{"LineNumber":112,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":54,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"35687971-36fe-4428-a5d5-fafaf825965f"},{"LineNumber":114,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":63,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"30d3aa37-e339-4e36-9a28-8021533b848e"},{"LineNumber":117,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":45,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"1970c7be-0734-49d5-b4b8-71ab209915c4"},{"LineNumber":122,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":42,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"f986286c-e424-43e6-9da4-c83cab340ac8"},{"LineNumber":125,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":55,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"e676941e-0b85-463e-a7b6-fb90305ed3cc"},{"LineNumber":127,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":14,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"031122f9-cd11-4440-800b-651cee880e10"},{"LineNumber":128,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":12,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"e96db203-0f47-4aa3-8824-9381c8594616"},{"LineNumber":129,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":12,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"c8fed0e6-6455-4a34-ab7c-b5c8301f2ce3"},{"LineNumber":131,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":27,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"05c933f9-fd57-4c41-91ee-ee2e0797a38a"},{"LineNumber":132,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":20,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"c3294b5c-d9a0-4382-863d-0f33607fdce1"},{"LineNumber":133,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":13,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"64a5068a-9927-4f2c-afd8-486ceb450295"},{"LineNumber":134,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":22,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"4244c315-74c5-4246-a7cb-591f73404913"},{"LineNumber":135,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":20,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"d5ed4feb-b030-4e65-948c-cc1a2810ae9e"},{"LineNumber":136,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":57,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"10471643-7fb9-4c10-8c18-c0a73b65ad03"},{"LineNumber":139,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":30,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"dba0de0f-c01e-4051-858f-18e5924ce83c"},{"LineNumber":141,"Hits":[4,4],"StartColumnNumbers":[0,15],"EndColumnNumbers":[13,23],"ContinuedLine":false,"Filterable":[false,false],"FilterDataUUID":["19d1442c-fc9e-4fbb-a9b6-5440599d8309","4a5072cc-681f-4d06-99af-eb2451f47a51"]},{"LineNumber":142,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":67,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"d9a7aa15-814e-486d-8bd8-a86a4b1cf4f9"},{"LineNumber":143,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":60,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"c9a74cb4-637b-4bde-a454-543e0c69e143"},{"LineNumber":144,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":44,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"2254932b-daa1-4824-b644-fee403d94308"},{"LineNumber":145,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":17,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"6f27691a-9596-4050-a48d-203ca1c3b099"},{"LineNumber":146,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":18,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"c8e5a5c1-8b6b-440b-8df1-9e0e615691a9"},{"LineNumber":147,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":19,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"32d2fcdc-7f1f-46d9-87c9-315d6e982646"},{"LineNumber":148,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":30,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"5d7dac34-f8b4-4acb-83ba-0ee47ed5a9c6"},{"LineNumber":149,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":21,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"8d5d4abf-26f2-4119-80b0-aefa904998e9"},{"LineNumber":150,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":20,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"011b0e62-7eda-445e-85af-ad2ae024d228"},{"LineNumber":151,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":21,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"31316f1d-8ba3-457d-b9c6-2dcb62a40ca1"},{"LineNumber":152,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":21,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"cf1e30a6-187e-48ac-8e34-0aa2f28dd88d"},{"LineNumber":153,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":51,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"d9781220-22b2-418b-96d4-1d7b372643d8"}]},"FilterData":[]}