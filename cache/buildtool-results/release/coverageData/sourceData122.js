var sourceData122 = {"FileName":"C:\\local\\mw\\gh-isaacito12-bev\\Components\\MotorDriveUnit\\Utility\\MotorDriveUnit_plotEfficiency.m","RawFileContents":["function fig = MotorDriveUnit_plotEfficiency(nvpairs)","%% Makes a plot of power conversion efficiency/losses for motor drive unit","% This function takes arguments corresponding to block parameters","% of the following blocks:","%","%   - Motor & Drive block, from Simscape Driveline","%   - Motor & Drive (System Level) block, from Simscape Electrical","%","% and makes a plot of electric-to-mechanical power conversion efficiency map","% as a function of motor speed and torque.","%","% You can run this function without arguments,","% and it will create a plot using default argument values.","%","% No that Motor & Drive (System Level) block supports","% various ways to accept block parameters, but","% this function makes a plot for it assuming the following case:","%","%   Electrical Torque","%     - Parameterized by: Maximum torque and power","%   Electrical Losses","%     - Parameterize losses by: Single efficiency measurement","%","% To make an efficiency plot for other cases","% in Motor & Drive (System Level) block,","% use the \"Plot efficiency map\" link in the block Description.","","% Copyright 2021-2023 The MathWorks, Inc.","","arguments","  % In road vehicle applications,","  % maximum motor speed is determined by vehicle top speed,","  % tire rolling radius, and reduction gear ratio. ","  nvpairs.MaxSpeed_rpm (1,1) double {mustBePositive} = 17000","","  nvpairs.MaxTorque_Nm (1,1) double {mustBePositive} = 163","  nvpairs.MaxPower_kW (1,1) double {mustBePositive} = 53","","  nvpairs.Efficiency_pct (1,1) double {mustBePositive} = 95","  nvpairs.Speed_measured_rpm (1,1) double {mustBeNonnegative} = 2000","  nvpairs.Torque_measured_Nm (1,1) double {mustBeNonnegative} = 50","","  % In Motor & Drive block from Simscape Driveline,","  % iron loss, constant electrical loss, and rotor friction are not modelled,","  % i.e., they are 0. ","  nvpairs.IronToNominalLossRatio_pct (1,1) double {mustBeNonnegative} = 0.1","  nvpairs.FixedLoss_W (1,1) double {mustBeNonnegative} = 40","  nvpairs.RotorDamping_Nm_per_radps (1,1) double {mustBeNonnegative} = 0.05","","  % Contour levels need 3 or more points for lower bound, upper bound,","  % and one or more points in between.","  nvpairs.ContourLevels_pct (1,:) double {mustBeNonnegative} = [1 60 80 90 92 94 96 97 98 99]","","  nvpairs.PlotResolution (1,1) {mustBeInteger, mustBePositive} = 500","end","","trq_max_Nm = nvpairs.MaxTorque_Nm;","","spd_max_rpm = nvpairs.MaxSpeed_rpm;","","power_max_W = 1000* nvpairs.MaxPower_kW;","","eff_norm = nvpairs.Efficiency_pct/100;","","spd_eff_rpm = nvpairs.Speed_measured_rpm;","","trq_eff_Nm = nvpairs.Torque_measured_Nm;","","% normalized","iron_to_nominal_loss_ratio = nvpairs.IronToNominalLossRatio_pct / 100;","","loss_const_W = nvpairs.FixedLoss_W;","","k_damp = nvpairs.RotorDamping_Nm_per_radps;","","contour_levels = nvpairs.ContourLevels_pct;","assert(numel(contour_levels) > 2, ...","  \"Contour levels need 3 or more elements, but \" ...","  + \"it has only \" + numel(contour_levels) + \" levels.\")","","plotResolution = nvpairs.PlotResolution;","","%% Derived parameters","","spd_eff_radps = spd_eff_rpm*2*pi/60;","","% Mechanical power at efficiency measurement point","mechpow_eff = spd_eff_radps * trq_eff_Nm;","","% Nominal loss (total loss at efficiency measurement point","nominal_loss_eff = (1/eff_norm - 1) * mechpow_eff;","","% Iron loss at efficiency measurement point","iron_loss_eff = iron_to_nominal_loss_ratio * nominal_loss_eff;","","% Copper loss at efficiency measurement point","copper_loss_eff = nominal_loss_eff - iron_loss_eff;","","% Copper loss coefficient for copper loss model","k_copper = copper_loss_eff/trq_eff_Nm^2;","","% Iron loss coefficient for iron loss model","k_iron = iron_loss_eff/spd_eff_radps^2;","","%% Plot","","% x-axis ... speed","w_rpm_vec = linspace(1, spd_max_rpm, plotResolution);","w_radps_vec = w_rpm_vec/60*2*pi;  % rad/s","","% y-axis ... torque","trq_Nm_vec = linspace(0, trq_max_Nm, plotResolution)';","","trq_max_envelope = min(power_max_W ./ w_radps_vec, trq_max_Nm);","","% Calculation below is done in x-y mesh.","[w, trq] = meshgrid(w_radps_vec, trq_Nm_vec);","","% A mask matrix with 1 for valid, 0 for invalid regions.","% This is later multiplied to the efficiency matrix","% to set regions over the maximum power to 0.","valid_region_mat = trq < trq_max_envelope;","","% Fixed electrical loss","Pb = loss_const_W*ones(plotResolution, plotResolution);","","kc = k_copper;  % Copper loss coefficient","ki = k_iron;  % Iron loss coefficient","kd = k_damp;  % Rotor friction coefficient","","trq_elec = abs(trq) - kd*w;  % Steady state","Lc = kc*trq_elec.^2;  % Copper loss model","Li = ki*w.^2;  % Iron loss model","L_elec = Pb + Lc + Li;  % Total electrical loss","mech_power = trq.*w;  % Mechanical power","eff = 100 * abs(mech_power) ./(L_elec + abs(mech_power));  % Efficiency in percent","","% Apply mask","eff = valid_region_mat .* eff;","","fig = figure;  hold on","contourf(w_rpm_vec, trq_Nm_vec, eff, contour_levels, ShowText=\"on\")","plot(w_rpm_vec, trq_max_envelope, LineWidth=3, Color=\"blue\")","sct = scatter(spd_eff_rpm, trq_eff_Nm, \"x\");","sct.Marker = \"x\";","sct.LineWidth = 1;","sct.SizeData = 100;","sct.MarkerEdgeColor = \"black\";","xlim([0 spd_max_rpm])","ylim([0 trq_max_Nm])","xlabel(\"Speed (rpm)\")","ylabel(\"Torque (Nm)\")","title(\"Overall Efficiency of Motor Drive Unit (%)\")","","end",""],"CoverageDisplayDataPerLine":{"Function":{"LineNumber":1,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":53,"ContinuedLine":false,"Filterable":true,"FilterDataUUID":"2bd98237-ee77-4e23-b7ec-dac3531d3a6d"},"Statement":[{"LineNumber":34,"Hits":[4,1],"StartColumnNumbers":[37,55],"EndColumnNumbers":[51,60],"ContinuedLine":false,"Filterable":[false,false],"FilterDataUUID":["ed7c70a0-d54f-491f-9837-ffb9981385bc","a729d3db-8b01-4513-89b3-f2f4bb358546"]},{"LineNumber":36,"Hits":[4,1],"StartColumnNumbers":[37,55],"EndColumnNumbers":[51,58],"ContinuedLine":false,"Filterable":[false,false],"FilterDataUUID":["926523fb-462a-4792-bc39-46b9d296c621","920569f5-63fa-46ca-a7b5-b0576ac47501"]},{"LineNumber":37,"Hits":[4,1],"StartColumnNumbers":[36,54],"EndColumnNumbers":[50,56],"ContinuedLine":false,"Filterable":[false,false],"FilterDataUUID":["61e42c76-8fff-48c3-9268-63d3712cc1af","4584126b-cbc3-4bed-976f-e69692ce2f20"]},{"LineNumber":39,"Hits":[4,1],"StartColumnNumbers":[39,57],"EndColumnNumbers":[53,59],"ContinuedLine":false,"Filterable":[false,false],"FilterDataUUID":["73f6ea32-3d1a-4cae-9162-ae0967d13588","6cb1a0c2-a28c-46c7-b6c0-b23ba05c580e"]},{"LineNumber":40,"Hits":[4,1],"StartColumnNumbers":[43,64],"EndColumnNumbers":[60,68],"ContinuedLine":false,"Filterable":[false,false],"FilterDataUUID":["cafc3309-cf53-42ea-840d-46c781201cc0","c62fedd0-1e8f-46ff-b5f5-8a89cbf7ad74"]},{"LineNumber":41,"Hits":[4,1],"StartColumnNumbers":[43,64],"EndColumnNumbers":[60,66],"ContinuedLine":false,"Filterable":[false,false],"FilterDataUUID":["3115737b-d0aa-4dc5-a83d-346ede0dd4a5","df96ba8f-c359-4ddd-be18-efb68a9d1656"]},{"LineNumber":46,"Hits":[4,1],"StartColumnNumbers":[51,72],"EndColumnNumbers":[68,75],"ContinuedLine":false,"Filterable":[false,false],"FilterDataUUID":["32a0b1cb-1be6-4696-9877-618c93f81cd9","5bcebc24-cded-41c4-83f4-803f1096718c"]},{"LineNumber":47,"Hits":[4,1],"StartColumnNumbers":[36,57],"EndColumnNumbers":[53,59],"ContinuedLine":false,"Filterable":[false,false],"FilterDataUUID":["2b6a9904-5ba5-4fd9-b8c7-2c4aafd95cb3","3b519022-dad7-41dd-b71a-17b389de3f5a"]},{"LineNumber":48,"Hits":[4,1],"StartColumnNumbers":[50,71],"EndColumnNumbers":[67,75],"ContinuedLine":false,"Filterable":[false,false],"FilterDataUUID":["335f7349-38ce-4309-886d-3734b6637aae","f5305871-dac3-47e2-a617-304198445a5f"]},{"LineNumber":52,"Hits":[4,1],"StartColumnNumbers":[42,63],"EndColumnNumbers":[59,93],"ContinuedLine":false,"Filterable":[false,false],"FilterDataUUID":["91a3e3ad-9338-4dde-86d9-c9c01aa738fa","184af2e8-96e0-4346-9634-608fda255872"]},{"LineNumber":54,"Hits":[4,4,1],"StartColumnNumbers":[32,47,65],"EndColumnNumbers":[45,61,68],"ContinuedLine":false,"Filterable":[false,false,false],"FilterDataUUID":["f1167509-4941-494a-8940-de4c888026ac","5ead85ae-ccbd-4385-9734-6121cc420987","42e05daf-c24f-4bb9-b56e-d6bfd2f396ac"]},{"LineNumber":57,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":34,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"70b89c7f-3355-47ea-9c5e-f105c060b825"},{"LineNumber":59,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":35,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"67be6459-a2f1-4eed-bec6-2e93fb6cd2f2"},{"LineNumber":61,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":40,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"74b22315-de5d-4a77-b589-3c2578e10ff2"},{"LineNumber":63,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":38,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"f53d7621-cf40-4a3f-ba91-9e0bf84e1682"},{"LineNumber":65,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":41,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"79a460e3-5b2b-4c75-abc0-36a2bbffe47b"},{"LineNumber":67,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":40,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"e2af48c9-8025-444c-9c86-d05a0d59603e"},{"LineNumber":70,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":70,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"2ac55a33-6da8-4b34-a05b-cb53bc0375ca"},{"LineNumber":72,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":35,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"c8f0bc7f-1f37-4647-bfe6-015444050351"},{"LineNumber":74,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":43,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"6e910a8e-59b7-4f94-bd5e-e28b0d8ce343"},{"LineNumber":76,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":43,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"9a96fd95-f3ba-4c91-ba59-756d715907fa"},{"LineNumber":77,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":32,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"45e33ba5-25bb-4540-b8f9-5db828094b78"},{"LineNumber":78,"Hits":4,"StartColumnNumbers":2,"EndColumnNumbers":48,"ContinuedLine":true,"Filterable":false,"FilterDataUUID":"45e33ba5-25bb-4540-b8f9-5db828094b78"},{"LineNumber":79,"Hits":4,"StartColumnNumbers":2,"EndColumnNumbers":56,"ContinuedLine":true,"Filterable":false,"FilterDataUUID":"45e33ba5-25bb-4540-b8f9-5db828094b78"},{"LineNumber":81,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":40,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"4b032d90-003d-4327-a971-ae28985ffa6d"},{"LineNumber":85,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":36,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"c13c7fe3-47c4-4112-9249-067d139aadde"},{"LineNumber":88,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":41,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"98e01908-6969-4231-9588-a8a281b6f55a"},{"LineNumber":91,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":50,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"6a09047d-89b0-40a4-ac70-e84b1c6dee3e"},{"LineNumber":94,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":62,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"9ff8a6d6-d590-4df6-8f62-aa77483611a3"},{"LineNumber":97,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":51,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"5f199a9e-aedc-482d-b8f6-6643428e3d60"},{"LineNumber":100,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":40,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"e9a82a94-ff70-4d64-bf3a-b48d04be2e2b"},{"LineNumber":103,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":39,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"d25ef549-b62b-4f0f-85dd-39f04cbb2583"},{"LineNumber":108,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":53,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"8748ffbf-eb14-49c1-9819-1d06cc0d50d6"},{"LineNumber":109,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":32,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"d49c3104-e6ea-447d-941f-34f8e36a836e"},{"LineNumber":112,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":54,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"ea20086b-0ea4-4caf-b5f0-6dcf531b0824"},{"LineNumber":114,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":63,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"a4c17f48-4273-46fc-96f6-679c75acb197"},{"LineNumber":117,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":45,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"b6610fc3-9b35-4926-a980-b675432acc87"},{"LineNumber":122,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":42,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"a17129ea-8762-4a24-a38c-5554fa5d70af"},{"LineNumber":125,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":55,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"55284815-bd09-44b5-9b95-caae074a5794"},{"LineNumber":127,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":14,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"7ee77275-a863-4c65-bb18-9852825769ec"},{"LineNumber":128,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":12,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"a6752ee2-3c9f-4b3e-99e0-fb4c0c99db26"},{"LineNumber":129,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":12,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"2a04b7b2-900e-4ad8-b142-d3cc14be9561"},{"LineNumber":131,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":27,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"ed7b368e-bafd-42e1-bba6-5bab3abc8441"},{"LineNumber":132,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":20,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"b7564627-c8f9-4be6-adf6-19eedb3401dd"},{"LineNumber":133,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":13,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"42ff3825-2fb5-4d08-a346-fcc072ff078d"},{"LineNumber":134,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":22,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"802e86d5-c89c-46aa-b5a1-0d720f8fb4e8"},{"LineNumber":135,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":20,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"71c8686b-d364-4f23-b745-251eefc70939"},{"LineNumber":136,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":57,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"6ac11195-dac3-4108-9e3e-2a1126b59dbc"},{"LineNumber":139,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":30,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"ff531ebb-08f8-4766-b5cd-a11fdd6e4464"},{"LineNumber":141,"Hits":[4,4],"StartColumnNumbers":[0,15],"EndColumnNumbers":[13,23],"ContinuedLine":false,"Filterable":[false,false],"FilterDataUUID":["30664ced-0e6f-489e-b1de-7bed3875a6e5","9c933273-4615-4952-8ca5-6baf29855231"]},{"LineNumber":142,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":67,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"486738cb-5172-40ec-a35d-f00c4c216afb"},{"LineNumber":143,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":60,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"e6b67b5b-e7dc-4a57-9f76-eab23a118a69"},{"LineNumber":144,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":44,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"b201015b-e269-43aa-ac07-cf5e5a20a4ab"},{"LineNumber":145,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":17,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"1d93a463-9d6e-4044-9228-cd7331cddace"},{"LineNumber":146,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":18,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"92019337-acd5-44ca-b1fb-9abe6672f9ec"},{"LineNumber":147,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":19,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"cafad8fa-50c4-4d05-8997-304117cd99f5"},{"LineNumber":148,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":30,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"ca3c75b6-3dfa-4939-aea7-f5f141558951"},{"LineNumber":149,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":21,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"f39d714f-5d05-4f34-9d4c-38fbd0910409"},{"LineNumber":150,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":20,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"dd366be2-9695-49be-bd4a-0d5929e0f7b7"},{"LineNumber":151,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":21,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"4ab41395-eff0-4d91-8c78-04ddf2112c97"},{"LineNumber":152,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":21,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"e6f8c7f3-a5d5-4380-a247-67242d323fc8"},{"LineNumber":153,"Hits":4,"StartColumnNumbers":0,"EndColumnNumbers":51,"ContinuedLine":false,"Filterable":false,"FilterDataUUID":"b5e1d561-e7ee-4b34-95a7-eda64cc3f589"}]},"FilterData":[]}